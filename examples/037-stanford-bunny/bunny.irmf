/*{
  "irmf": "1.0",
  "language": "wgsl",
  "materials": ["Material"],
  "min": [-28.9382, -46.4000, -0.1195],
  "max": [89.5835, 50.1819, 118.5614],
  "notes": "Fourier Approximation",
  "units": "mm"
}*/

const MIN_BOUND = vec3f(-28.9382, -46.4000, -0.1195);
const MAX_BOUND = vec3f(89.5835, 50.1819, 118.5614);
const DIMS = vec3f(128.0, 128.0, 128.0);
const VOXEL_SIZE = (MAX_BOUND - MIN_BOUND) / DIMS;
const solidMaterial = vec4f(1.0, 0.0, 0.0, 0.0);

fn cuboid(v: vec3i, b_min: vec3i, b_max: vec3i) -> bool {
    return all(v >= b_min) && all(v <= b_max);
}

const coeffs_re = array<f32, 2106>(
    0.020162, 0.009048, -0.014278, 0.059574, 0.002314, -0.005146, -0.003533, 0.006148, 
    -0.020335, 0.114126, -0.017922, 0.004961, 0.017130, 0.002503, -0.004306, -0.026047, 
    0.231860, 0.002677, -0.000782, -0.004315, -0.032829, -0.069068, -0.132309, 0.040596, 
    0.104370, 0.061400, 0.044948, 0.005142, 0.009363, 0.026118, -0.244087, 0.023603, 
    0.006212, -0.005801, -0.008636, 0.012949, 0.012537, -0.112327, 0.016579, -0.019058, 
    -0.009745, -0.008703, 0.016802, -0.061179, -0.000913, 0.002247, -0.014948, 0.043450, 
    0.001492, 0.002590, -0.001493, -0.003882, 0.034734, -0.016524, 0.008443, -0.000564, 
    0.004495, -0.002356, 0.006318, -0.003981, 0.064699, -0.035079, 0.038705, -0.009580, 
    -0.013803, 0.003198, -0.000195, 0.013670, -0.029979, 0.122015, -0.037703, -0.005714, 
    -0.001377, -0.007937, -0.006251, -0.002313, -0.009991, -0.009875, -0.021738, 0.283158, 
    0.055379, -0.023973, -0.004515, 0.000311, -0.010288, -0.016998, -0.041905, -0.039240, 
    -0.063397, -0.128000, 0.087239, 0.053667, 0.042363, 0.047854, 0.055487, 0.014571, 
    0.000587, 0.005021, -0.000470, 0.005562, -0.001762, -0.290830, 0.042700, 0.006711, 
    0.029067, 0.002131, 0.006711, -0.000007, 0.003762, -0.002382, 0.043254, -0.118912, 
    0.022709, 0.005642, -0.028111, -0.002931, 0.000806, 0.007624, -0.006032, 0.012854, 
    -0.087344, 0.040094, -0.012780, -0.003013, -0.001869, 0.004256, 0.005307, -0.001159, 
    -0.039911, 0.000780, -0.003355, 0.006246, 0.015783, -0.041543, 0.002555, -0.002279, 
    0.036814, 0.002281, -0.004782, 0.008978, -0.010250, 0.069115, -0.013516, 0.000884, 
    -0.009895, -0.004775, -0.003041, 0.000518, 0.006858, 0.071328, -0.007541, -0.014390, 
    0.027359, -0.015392, 0.002567, -0.000816, -0.007482, -0.015408, -0.014364, 0.091576, 
    0.009829, 0.001404, -0.030443, 0.006707, 0.014160, -0.006142, 0.009846, 0.004872, 
    0.019631, -0.048283, 0.153848, 0.013228, -0.053647, 0.035432, -0.013815, -0.009152, 
    0.001319, -0.010905, -0.001743, -0.007526, -0.016258, -0.029849, 0.334207, 0.013510, 
    0.007547, -0.019542, 0.007734, 0.000711, -0.002064, -0.019543, -0.022732, -0.045591, 
    -0.066880, -0.091572, -0.164105, 0.104238, 0.080875, 0.095983, 0.069133, 0.044213, 
    0.040320, 0.023493, -0.002879, 0.003320, 0.011713, 0.034873, -0.003414, 0.032743, 
    -0.330031, 0.074170, -0.029475, -0.023740, -0.006638, 0.001694, -0.007806, 0.002920, 
    -0.002639, -0.003450, -0.001443, 0.021812, -0.163928, 0.047065, -0.023335, -0.007632, 
    0.009283, -0.004037, -0.002178, -0.009407, 0.004923, 0.003770, 0.010849, -0.103078, 
    -0.010394, 0.023294, 0.004934, 0.002335, 0.007466, 0.000182, -0.002741, -0.004441, 
    0.021698, -0.063441, 0.012718, -0.006711, -0.004006, 0.008014, 0.001081, 0.001999, 
    0.006894, -0.052313, -0.000375, 0.004850, 0.003284, -0.001070, -0.043919, 0.001483, 
    0.001595, 0.004711, -0.002510, 0.050997, -0.006890, 0.008316, -0.000976, -0.001631, 
    -0.011630, 0.004601, -0.014064, 0.078357, -0.005940, -0.019852, -0.004567, -0.001242, 
    -0.002126, -0.005239, 0.008690, -0.007279, -0.009533, 0.061960, -0.030220, 0.007615, 
    0.012318, -0.001496, -0.003642, -0.000209, 0.006101, -0.001862, 0.001369, -0.005247, 
    -0.005871, 0.078281, -0.036816, 0.009796, -0.028979, 0.011875, -0.006046, 0.008665, 
    0.011337, 0.000736, -0.006622, 0.014397, 0.022668, -0.039166, 0.253556, -0.110753, 
    0.031480, 0.015456, -0.009057, 0.011764, -0.018712, -0.005051, 0.003897, 0.002948, 
    -0.030871, -0.019837, -0.011867, 0.486455, 0.011709, -0.042738, -0.030384, -0.002319, 
    0.002416, -0.014979, -0.020030, -0.019681, -0.052209, -0.067144, -0.123389, -0.129378, 
    0.150340, 0.103276, 0.087608, 0.043526, 0.033689, 0.029379, 0.030103, -0.017256, 
    -0.000144, -0.005421, 0.029372, 0.018104, -0.008331, -0.448699, 0.082903, 0.069071, 
    0.034279, 0.016914, -0.005309, 0.015972, -0.003054, 0.010690, -0.009316, -0.000982, 
    0.038431, 0.017369, -0.266994, 0.046485, 0.004796, 0.002410, 0.029042, -0.004959, 
    0.003176, 0.012931, -0.007691, -0.009126, 0.008040, -0.000255, 0.024652, -0.130616, 
    0.039761, -0.011310, 0.031823, -0.028329, 0.013468, -0.002099, 0.000375, 0.017755, 
    -0.012356, 0.002214, 0.005549, -0.060498, -0.003593, 0.002435, -0.009794, 0.000575, 
    -0.004894, -0.002761, 0.008178, -0.001772, -0.000157, -0.065545, -0.002383, 0.007311, 
    0.001047, 0.004195, -0.011474, 0.005781, 0.008731, -0.063794, 0.007802, 0.000929, 
    0.005586, 0.000700, -0.015293, 0.065522, -0.001324, 0.001596, 0.001428, -0.000288, 
    -0.007733, 0.002230, 0.071877, -0.009908, 0.009432, -0.005151, 0.003126, -0.001483, 
    0.007247, -0.008990, -0.000469, -0.017247, 0.090949, -0.001534, -0.002795, -0.008632, 
    0.010231, -0.010099, 0.001280, 0.003917, -0.010357, 0.014859, 0.015983, -0.019387, 
    0.123855, -0.053157, 0.034968, 0.008554, -0.012321, 0.000751, 0.007438, -0.005005, 
    -0.004165, -0.004364, 0.011169, -0.040159, 0.014983, 0.151960, 0.050438, -0.058254, 
    0.004984, 0.010234, -0.017751, 0.001363, -0.001191, -0.003174, 0.006433, -0.028681, 
    0.024244, 0.024494, -0.124544, 0.255433, 0.021241, 0.065720, -0.014727, -0.007292, 
    0.022457, -0.006838, -0.006988, 0.002375, -0.000236, 0.004118, 0.012899, -0.056051, 
    0.017244, -0.056238, 0.532127, 0.103627, -0.227880, 0.022531, -0.035233, 0.006054, 
    -0.007778, -0.002940, -0.051085, -0.047742, -0.030523, -0.070785, -0.085981, -0.173380, 
    -0.286716, 0.221526, 0.125573, 0.406325, 0.117148, 0.043903, 0.063768, 0.041711, 
    0.044629, 0.003586, -0.000872, -0.005670, -0.018663, 0.024359, 0.006157, -0.036206, 
    -0.591457, 0.202874, -0.051422, 0.049203, 0.017715, -0.002928, 0.013772, 0.003420, 
    0.008037, 0.007270, -0.018235, -0.007896, 0.020016, 0.029269, 0.079705, -0.293499, 
    0.005353, -0.046528, -0.004116, 0.011667, 0.003326, 0.002403, 0.008152, -0.000511, 
    0.006060, 0.030715, -0.050701, 0.006545, 0.032536, -0.147185, -0.010018, -0.001456, 
    -0.029975, 0.021258, -0.002266, -0.001131, 0.006935, -0.011854, 0.012570, 0.008919, 
    -0.013375, 0.008054, -0.078442, -0.002776, -0.003330, 0.002563, 0.002706, -0.003128, 
    -0.012011, -0.002618, 0.000669, -0.011677, 0.011947, 0.019962, -0.104079, 0.004311, 
    -0.008981, 0.005449, 0.001319, 0.004408, 0.008505, -0.004719, 0.006349, 0.009069, 
    -0.069754, 0.005012, -0.000580, -0.009429, -0.002035, -0.000404, 0.008248, -0.061167, 
    0.007317, -0.010363, -0.000925, 0.002917, -0.004250, 0.085081, -0.015276, 0.000600, 
    -0.009011, 0.000567, 0.003734, -0.007480, 0.005436, 0.111658, -0.024020, -0.006421, 
    -0.006328, 0.004425, -0.003097, 0.012180, 0.004970, 0.002016, -0.011406, 0.125921, 
    -0.017917, 0.001889, -0.016027, -0.012445, 0.002332, 0.001431, -0.011212, -0.008643, 
    -0.001864, 0.011626, -0.002605, 0.153883, -0.061012, -0.008955, 0.003825, -0.004951, 
    -0.000801, 0.009036, 0.002025, 0.005284, 0.005415, 0.017434, 0.012984, -0.088268, 
    0.029080, 0.209251, -0.016531, 0.011625, -0.032224, -0.000430, 0.014832, -0.022813, 
    -0.007930, 0.012796, 0.021654, 0.023407, -0.002363, 0.049624, 0.096259, -0.017837, 
    0.366328, -0.160724, -0.020795, -0.041324, -0.025742, -0.010454, -0.005478, -0.018809, 
    0.004165, 0.017500, 0.016790, 0.015068, -0.042779, 0.046628, 0.004593, 1.153458, 
    -0.476648, -0.054481, -0.039897, -0.033689, -0.053802, 0.004341, -0.028730, -0.063473, 
    -0.077292, -0.091872, -0.116628, -0.144802, -0.158362, -0.663819, 1.043357, 0.408799, 
    0.211483, 0.152484, 0.155555, 0.094260, 0.070400, 0.067419, 0.014044, -0.010497, 
    -0.016975, 0.013601, 0.097423, -0.041795, 0.051074, -1.151832, 0.074620, 0.017816, 
    0.061381, -0.004906, 0.018185, 0.001323, 0.011322, -0.012169, 0.009086, 0.013012, 
    -0.004480, -0.109744, 0.116215, 0.091876, -0.507771, 0.097703, -0.095763, 0.073151, 
    -0.018328, 0.000238, -0.002087, 0.005217, 0.006027, 0.002989, -0.035900, 0.044308, 
    -0.017738, -0.003555, -0.030633, -0.162740, 0.067014, 0.028914, -0.015582, -0.008247, 
    -0.000618, 0.001749, -0.004114, -0.003850, -0.002056, 0.004422, 0.010437, -0.007108, 
    0.037276, -0.163021, 0.004655, -0.001029, 0.001970, 0.003221, 0.000190, 0.001068, 
    0.010597, -0.007417, -0.006975, 0.017114, -0.000709, -0.148989, 0.033943, -0.004563, 
    0.010934, 0.001800, 0.013963, 0.006274, 0.002336, -0.003016, 0.003317, -0.111080, 
    0.026226, -0.000494, 0.009366, -0.007534, 0.001623, -0.001341, 0.007137, -0.096099, 
    0.019028, 0.004161, 0.003295, 0.004420, -0.006166, -0.038209, 0.206746, -0.069241, 
    0.005560, -0.009944, -0.001254, -0.005544, -0.009861, -0.007402, -0.034681, 0.241741, 
    -0.080437, 0.006058, -0.011768, -0.002203, 0.004377, -0.003858, -0.000006, 0.000051, 
    0.007815, -0.009225, -0.052618, 0.282113, -0.108749, 0.018021, -0.000658, -0.003186, 
    0.004934, -0.000316, 0.007518, -0.005344, -0.009336, -0.002961, -0.005416, -0.046461, 
    0.357057, -0.139383, 0.020466, -0.031996, -0.000054, -0.001755, -0.011553, 0.001047, 
    0.004020, 0.002238, -0.011618, 0.032353, -0.025677, -0.154736, 0.529937, -0.187805, 
    0.047041, -0.015659, -0.028032, 0.032593, -0.001944, -0.008377, -0.006734, -0.003837, 
    0.000362, -0.000996, -0.005778, -0.003483, -0.069855, 0.737351, -0.138695, -0.213620, 
    0.030665, 0.035156, -0.026977, -0.002979, 0.011993, -0.028928, -0.029613, -0.015765, 
    -0.031745, -0.107671, -0.031914, -0.594818, 1.015837, -0.687014, 0.414545, -0.061337, 
    0.090596, 0.007010, 0.021208, 0.017800, -0.166005, -0.226861, -0.246689, -0.291783, 
    -0.412976, -0.783678, -1.714890, 3.296679, 2.577397, 0.343685, 0.364309, 0.339415, 
    0.221526, 0.203477, 0.181950, 0.028012, 0.044467, 0.030353, 0.000627, 0.013043, 
    0.388184, 0.526558, -2.691596, 0.654011, -0.025721, -0.050638, 0.008034, -0.036662, 
    -0.002142, -0.004202, -0.010629, 0.004958, -0.019224, 0.054722, -0.075912, 0.067481, 
    -0.005788, -0.469339, 0.154597, -0.010134, -0.022731, 0.000445, 0.022519, -0.024750, 
    -0.000288, 0.008491, 0.004363, -0.010832, 0.025730, 0.024250, -0.062103, 0.151763, 
    -0.436318, 0.116523, 0.005619, 0.009644, 0.003143, 0.000102, -0.002810, -0.008682, 
    -0.007479, 0.012666, -0.034681, 0.035925, 0.001082, 0.084461, -0.315426, 0.070247, 
    -0.000281, 0.004367, -0.003959, 0.005139, 0.001791, -0.018410, 0.014174, 0.006596, 
    0.004128, -0.000670, 0.047156, -0.250358, 0.086318, 0.002554, 0.007282, -0.004769, 
    -0.004862, 0.002381, 0.001179, -0.008939, 0.015754, 0.001918, 0.050397, -0.205167, 
    0.063381, -0.004089, -0.000401, -0.003887, 0.000006, 0.003502, -0.002951, 0.045059, 
    -0.174358, 0.051915, -0.000794, 0.003266, 0.034976, -0.006453, 0.004319, -0.077760, 
    0.063170, 0.056719, -0.006731, 0.006846, -0.002575, -0.003326, -0.015797, 0.014570, 
    -0.087185, 0.104271, 0.066722, -0.020456, 0.005550, 0.002755, -0.000075, -0.002651, 
    -0.011000, -0.006615, 0.001280, -0.001162, -0.098925, 0.146026, 0.060618, -0.016762, 
    0.017364, 0.004730, -0.001951, 0.014663, -0.003074, 0.003549, -0.017781, -0.023352, 
    0.010713, -0.135545, 0.277380, 0.109927, -0.020314, -0.001108, 0.008331, 0.028428, 
    -0.009893, -0.008690, -0.012126, 0.009237, -0.011708, -0.041625, 0.037277, -0.200597, 
    0.560235, 0.161973, -0.097540, 0.125648, -0.020558, 0.004294, 0.013952, 0.011830, 
    -0.010800, -0.010753, -0.031046, 0.004603, -0.050921, 0.009778, -0.246446, 1.135375, 
    0.385596, -0.155627, -0.033767, 0.023686, 0.000849, -0.004963, 0.006268, -0.021590, 
    -0.026391, -0.021554, -0.054725, -0.045989, -0.058368, -0.742041, 5.946931, -0.000971, 
    -0.229532, -0.031085, 0.059636, 0.004134, 0.015517, -0.000323, 0.041238, 0.066639, 
    0.098319, 0.133263, 0.239476, 0.589463, 1.508348, 4.410724, 14.359890, 4.410724, 
    1.508348, 0.589463, 0.239476, 0.133263, 0.098319, 0.066639, -0.000323, 0.015517, 
    0.004134, 0.059636, -0.031085, -0.229532, -0.000971, 5.946931, -0.742041, -0.058368, 
    -0.045989, -0.054725, -0.021554, -0.026391, -0.021590, 0.006268, -0.004963, 0.000849, 
    0.023686, -0.033767, -0.155627, 0.385596, 1.135375, -0.246446, 0.009778, -0.050921, 
    0.004603, -0.031046, -0.010753, -0.010800, 0.011830, 0.013952, 0.004294, -0.020558, 
    0.125648, -0.097540, 0.161973, 0.560235, -0.200597, 0.037277, -0.041625, -0.011708, 
    0.009237, -0.012126, -0.008690, -0.009893, 0.028428, 0.008331, -0.001108, -0.020314, 
    0.109927, 0.277380, -0.135545, 0.010713, -0.023352, -0.017781, 0.003549, -0.003074, 
    0.014663, -0.001951, 0.004730, 0.017364, -0.016762, 0.060618, 0.146026, -0.098925, 
    -0.001162, 0.001280, -0.006615, -0.011000, -0.002651, -0.000075, 0.002755, 0.005550, 
    -0.020456, 0.066722, 0.104271, -0.087185, 0.014570, -0.015797, -0.003326, -0.002575, 
    0.006846, -0.006731, 0.056719, 0.063170, -0.077760, 0.004319, -0.006453, 0.003266, 
    -0.000794, 0.051915, -0.174358, 0.045059, -0.002951, 0.003502, 0.000006, -0.003887, 
    -0.000401, -0.004089, 0.063381, -0.205167, 0.050397, 0.001918, 0.015754, -0.008939, 
    0.001179, 0.002381, -0.004862, -0.004769, 0.007282, 0.002554, 0.086318, -0.250358, 
    0.047156, -0.000670, 0.004128, 0.006596, 0.014174, -0.018410, 0.001791, 0.005139, 
    -0.003959, 0.004367, -0.000281, 0.070247, -0.315426, 0.084461, 0.001082, 0.035925, 
    -0.034681, 0.012666, -0.007479, -0.008682, -0.002810, 0.000102, 0.003143, 0.009644, 
    0.005619, 0.116523, -0.436318, 0.151763, -0.062103, 0.024250, 0.025730, -0.010832, 
    0.004363, 0.008491, -0.000288, -0.024750, 0.022519, 0.000445, -0.022731, -0.010134, 
    0.154597, -0.469339, -0.005788, 0.067481, -0.075912, 0.054722, -0.019224, 0.004958, 
    -0.010629, -0.004202, -0.002142, -0.036662, 0.008034, -0.050638, -0.025721, 0.654011, 
    -2.691596, 0.526558, 0.388184, 0.013043, 0.000627, 0.030353, 0.044467, 0.028012, 
    0.181950, 0.203477, 0.221526, 0.339415, 0.364309, 0.343685, 2.577397, 3.296679, 
    -1.714890, -0.783678, -0.412976, -0.291783, -0.246689, -0.226861, -0.166005, 0.017800, 
    0.021208, 0.007010, 0.090596, -0.061337, 0.414545, -0.687014, 1.015837, -0.594818, 
    -0.031914, -0.107671, -0.031745, -0.015765, -0.029613, -0.028928, 0.011993, -0.002979, 
    -0.026977, 0.035156, 0.030665, -0.213620, -0.138695, 0.737351, -0.069855, -0.003483, 
    -0.005778, -0.000996, 0.000362, -0.003837, -0.006734, -0.008377, -0.001944, 0.032593, 
    -0.028032, -0.015659, 0.047041, -0.187805, 0.529937, -0.154736, -0.025677, 0.032353, 
    -0.011618, 0.002238, 0.004020, 0.001047, -0.011553, -0.001755, -0.000054, -0.031996, 
    0.020466, -0.139383, 0.357057, -0.046461, -0.005416, -0.002961, -0.009336, -0.005344, 
    0.007518, -0.000316, 0.004934, -0.003186, -0.000658, 0.018021, -0.108749, 0.282113, 
    -0.052618, -0.009225, 0.007815, 0.000051, -0.000006, -0.003858, 0.004377, -0.002203, 
    -0.011768, 0.006058, -0.080437, 0.241741, -0.034681, -0.007402, -0.009861, -0.005544, 
    -0.001254, -0.009944, 0.005560, -0.069241, 0.206746, -0.038209, -0.006166, 0.004420, 
    0.003295, 0.004161, 0.019028, -0.096099, 0.007137, -0.001341, 0.001623, -0.007534, 
    0.009366, -0.000494, 0.026226, -0.111080, 0.003317, -0.003016, 0.002336, 0.006274, 
    0.013963, 0.001800, 0.010934, -0.004563, 0.033943, -0.148989, -0.000709, 0.017114, 
    -0.006975, -0.007417, 0.010597, 0.001068, 0.000190, 0.003221, 0.001970, -0.001029, 
    0.004655, -0.163021, 0.037276, -0.007108, 0.010437, 0.004422, -0.002056, -0.003850, 
    -0.004114, 0.001749, -0.000618, -0.008247, -0.015582, 0.028914, 0.067014, -0.162740, 
    -0.030633, -0.003555, -0.017738, 0.044308, -0.035900, 0.002989, 0.006027, 0.005217, 
    -0.002087, 0.000238, -0.018328, 0.073151, -0.095763, 0.097703, -0.507771, 0.091876, 
    0.116215, -0.109744, -0.004480, 0.013012, 0.009086, -0.012169, 0.011322, 0.001323, 
    0.018185, -0.004906, 0.061381, 0.017816, 0.074620, -1.151832, 0.051074, -0.041795, 
    0.097423, 0.013601, -0.016975, -0.010497, 0.014044, 0.067419, 0.070400, 0.094260, 
    0.155555, 0.152484, 0.211483, 0.408799, 1.043357, -0.663819, -0.158362, -0.144802, 
    -0.116628, -0.091872, -0.077292, -0.063473, -0.028730, 0.004341, -0.053802, -0.033689, 
    -0.039897, -0.054481, -0.476648, 1.153458, 0.004593, 0.046628, -0.042779, 0.015068, 
    0.016790, 0.017500, 0.004165, -0.018809, -0.005478, -0.010454, -0.025742, -0.041324, 
    -0.020795, -0.160724, 0.366328, -0.017837, 0.096259, 0.049624, -0.002363, 0.023407, 
    0.021654, 0.012796, -0.007930, -0.022813, 0.014832, -0.000430, -0.032224, 0.011625, 
    -0.016531, 0.209251, 0.029080, -0.088268, 0.012984, 0.017434, 0.005415, 0.005284, 
    0.002025, 0.009036, -0.000801, -0.004951, 0.003825, -0.008955, -0.061012, 0.153883, 
    -0.002605, 0.011626, -0.001864, -0.008643, -0.011212, 0.001431, 0.002332, -0.012445, 
    -0.016027, 0.001889, -0.017917, 0.125921, -0.011406, 0.002016, 0.004970, 0.012180, 
    -0.003097, 0.004425, -0.006328, -0.006421, -0.024020, 0.111658, 0.005436, -0.007480, 
    0.003734, 0.000567, -0.009011, 0.000600, -0.015276, 0.085081, -0.004250, 0.002917, 
    -0.000925, -0.010363, 0.007317, -0.061167, 0.008248, -0.000404, -0.002035, -0.009429, 
    -0.000580, 0.005012, -0.069754, 0.009069, 0.006349, -0.004719, 0.008505, 0.004408, 
    0.001319, 0.005449, -0.008981, 0.004311, -0.104079, 0.019962, 0.011947, -0.011677, 
    0.000669, -0.002618, -0.012011, -0.003128, 0.002706, 0.002563, -0.003330, -0.002776, 
    -0.078442, 0.008054, -0.013375, 0.008919, 0.012570, -0.011854, 0.006935, -0.001131, 
    -0.002266, 0.021258, -0.029975, -0.001456, -0.010018, -0.147185, 0.032536, 0.006545, 
    -0.050701, 0.030715, 0.006060, -0.000511, 0.008152, 0.002403, 0.003326, 0.011667, 
    -0.004116, -0.046528, 0.005353, -0.293499, 0.079705, 0.029269, 0.020016, -0.007896, 
    -0.018235, 0.007270, 0.008037, 0.003420, 0.013772, -0.002928, 0.017715, 0.049203, 
    -0.051422, 0.202874, -0.591457, -0.036206, 0.006157, 0.024359, -0.018663, -0.005670, 
    -0.000872, 0.003586, 0.044629, 0.041711, 0.063768, 0.043903, 0.117148, 0.406325, 
    0.125573, 0.221526, -0.286716, -0.173380, -0.085981, -0.070785, -0.030523, -0.047742, 
    -0.051085, -0.002940, -0.007778, 0.006054, -0.035233, 0.022531, -0.227880, 0.103627, 
    0.532127, -0.056238, 0.017244, -0.056051, 0.012899, 0.004118, -0.000236, 0.002375, 
    -0.006988, -0.006838, 0.022457, -0.007292, -0.014727, 0.065720, 0.021241, 0.255433, 
    -0.124544, 0.024494, 0.024244, -0.028681, 0.006433, -0.003174, -0.001191, 0.001363, 
    -0.017751, 0.010234, 0.004984, -0.058254, 0.050438, 0.151960, 0.014983, -0.040159, 
    0.011169, -0.004364, -0.004165, -0.005005, 0.007438, 0.000751, -0.012321, 0.008554, 
    0.034968, -0.053157, 0.123855, -0.019387, 0.015983, 0.014859, -0.010357, 0.003917, 
    0.001280, -0.010099, 0.010231, -0.008632, -0.002795, -0.001534, 0.090949, -0.017247, 
    -0.000469, -0.008990, 0.007247, -0.001483, 0.003126, -0.005151, 0.009432, -0.009908, 
    0.071877, 0.002230, -0.007733, -0.000288, 0.001428, 0.001596, -0.001324, 0.065522, 
    -0.015293, 0.000700, 0.005586, 0.000929, 0.007802, -0.063794, 0.008731, 0.005781, 
    -0.011474, 0.004195, 0.001047, 0.007311, -0.002383, -0.065545, -0.000157, -0.001772, 
    0.008178, -0.002761, -0.004894, 0.000575, -0.009794, 0.002435, -0.003593, -0.060498, 
    0.005549, 0.002214, -0.012356, 0.017755, 0.000375, -0.002099, 0.013468, -0.028329, 
    0.031823, -0.011310, 0.039761, -0.130616, 0.024652, -0.000255, 0.008040, -0.009126, 
    -0.007691, 0.012931, 0.003176, -0.004959, 0.029042, 0.002410, 0.004796, 0.046485, 
    -0.266994, 0.017369, 0.038431, -0.000982, -0.009316, 0.010690, -0.003054, 0.015972, 
    -0.005309, 0.016914, 0.034279, 0.069071, 0.082903, -0.448699, -0.008331, 0.018104, 
    0.029372, -0.005421, -0.000144, -0.017256, 0.030103, 0.029379, 0.033689, 0.043526, 
    0.087608, 0.103276, 0.150340, -0.129378, -0.123389, -0.067144, -0.052209, -0.019681, 
    -0.020030, -0.014979, 0.002416, -0.002319, -0.030384, -0.042738, 0.011709, 0.486455, 
    -0.011867, -0.019837, -0.030871, 0.002948, 0.003897, -0.005051, -0.018712, 0.011764, 
    -0.009057, 0.015456, 0.031480, -0.110753, 0.253556, -0.039166, 0.022668, 0.014397, 
    -0.006622, 0.000736, 0.011337, 0.008665, -0.006046, 0.011875, -0.028979, 0.009796, 
    -0.036816, 0.078281, -0.005871, -0.005247, 0.001369, -0.001862, 0.006101, -0.000209, 
    -0.003642, -0.001496, 0.012318, 0.007615, -0.030220, 0.061960, -0.009533, -0.007279, 
    0.008690, -0.005239, -0.002126, -0.001242, -0.004567, -0.019852, -0.005940, 0.078357, 
    -0.014064, 0.004601, -0.011630, -0.001631, -0.000976, 0.008316, -0.006890, 0.050997, 
    -0.002510, 0.004711, 0.001595, 0.001483, -0.043919, -0.001070, 0.003284, 0.004850, 
    -0.000375, -0.052313, 0.006894, 0.001999, 0.001081, 0.008014, -0.004006, -0.006711, 
    0.012718, -0.063441, 0.021698, -0.004441, -0.002741, 0.000182, 0.007466, 0.002335, 
    0.004934, 0.023294, -0.010394, -0.103078, 0.010849, 0.003770, 0.004923, -0.009407, 
    -0.002178, -0.004037, 0.009283, -0.007632, -0.023335, 0.047065, -0.163928, 0.021812, 
    -0.001443, -0.003450, -0.002639, 0.002920, -0.007806, 0.001694, -0.006638, -0.023740, 
    -0.029475, 0.074170, -0.330031, 0.032743, -0.003414, 0.034873, 0.011713, 0.003320, 
    -0.002879, 0.023493, 0.040320, 0.044213, 0.069133, 0.095983, 0.080875, 0.104238, 
    -0.164105, -0.091572, -0.066880, -0.045591, -0.022732, -0.019543, -0.002064, 0.000711, 
    0.007734, -0.019542, 0.007547, 0.013510, 0.334207, -0.029849, -0.016258, -0.007526, 
    -0.001743, -0.010905, 0.001319, -0.009152, -0.013815, 0.035432, -0.053647, 0.013228, 
    0.153848, -0.048283, 0.019631, 0.004872, 0.009846, -0.006142, 0.014160, 0.006707, 
    -0.030443, 0.001404, 0.009829, 0.091576, -0.014364, -0.015408, -0.007482, -0.000816, 
    0.002567, -0.015392, 0.027359, -0.014390, -0.007541, 0.071328, 0.006858, 0.000518, 
    -0.003041, -0.004775, -0.009895, 0.000884, -0.013516, 0.069115, -0.010250, 0.008978, 
    -0.004782, 0.002281, 0.036814, -0.002279, 0.002555, -0.041543, 0.015783, 0.006246, 
    -0.003355, 0.000780, -0.039911, -0.001159, 0.005307, 0.004256, -0.001869, -0.003013, 
    -0.012780, 0.040094, -0.087344, 0.012854, -0.006032, 0.007624, 0.000806, -0.002931, 
    -0.028111, 0.005642, 0.022709, -0.118912, 0.043254, -0.002382, 0.003762, -0.000007, 
    0.006711, 0.002131, 0.029067, 0.006711, 0.042700, -0.290830, -0.001762, 0.005562, 
    -0.000470, 0.005021, 0.000587, 0.014571, 0.055487, 0.047854, 0.042363, 0.053667, 
    0.087239, -0.128000, -0.063397, -0.039240, -0.041905, -0.016998, -0.010288, 0.000311, 
    -0.004515, -0.023973, 0.055379, 0.283158, -0.021738, -0.009875, -0.009991, -0.002313, 
    -0.006251, -0.007937, -0.001377, -0.005714, -0.037703, 0.122015, -0.029979, 0.013670, 
    -0.000195, 0.003198, -0.013803, -0.009580, 0.038705, -0.035079, 0.064699, -0.003981, 
    0.006318, -0.002356, 0.004495, -0.000564, 0.008443, -0.016524, 0.034734, -0.003882, 
    -0.001493, 0.002590, 0.001492, 0.043450, -0.014948, 0.002247, -0.000913, -0.061179, 
    0.016802, -0.008703, -0.009745, -0.019058, 0.016579, -0.112327, 0.012537, 0.012949, 
    -0.008636, -0.005801, 0.006212, 0.023603, -0.244087, 0.026118, 0.009363, 0.005142, 
    0.044948, 0.061400, 0.104370, 0.040596, -0.132309, -0.069068, -0.032829, -0.004315, 
    -0.000782, 0.002677, 0.231860, -0.026047, -0.004306, 0.002503, 0.017130, 0.004961, 
    -0.017922, 0.114126, -0.020335, 0.006148, -0.003533, -0.005146, 0.002314, 0.059574, 
    -0.014278, 0.009048
);

const coeffs_im = array<f32, 2106>(
    -0.294135, -0.001000, 0.011190, -0.015943, 0.004786, 0.009136, 0.005186, 0.020171, 
    -0.004715, -0.006476, -0.009927, -0.022387, 0.006601, -0.003774, -0.017460, 0.018323, 
    0.051486, 0.052972, -0.015837, 0.002076, 0.008504, 0.017885, 0.017831, -0.338155, 
    -0.047676, 0.011763, 0.005930, 0.010359, -0.005805, 0.037703, 0.075341, 0.011598, 
    -0.009877, -0.008845, -0.004406, -0.027277, -0.006272, 0.020490, -0.006057, 0.003262, 
    0.018567, 0.004552, 0.002056, 0.015100, 0.007456, 0.005506, 0.004356, 0.003055, 
    -0.000421, -0.003670, 0.001324, -0.004491, -0.005648, 0.000295, -0.001378, 0.007094, 
    0.000013, -0.001694, -0.011196, 0.013546, -0.020155, 0.020559, 0.017781, 0.011845, 
    -0.001907, 0.000431, 0.003861, 0.019759, -0.013480, 0.004472, -0.026651, 0.011440, 
    -0.028494, -0.005020, -0.004406, 0.007130, -0.008424, -0.025808, 0.038571, 0.065626, 
    0.071264, -0.033278, 0.010609, 0.001257, -0.010636, 0.014185, 0.007556, 0.009434, 
    0.038679, 0.024747, -0.465769, -0.091509, 0.045097, 0.021599, -0.009395, -0.002884, 
    -0.006546, -0.002958, 0.009523, -0.024635, 0.042547, 0.114359, 0.042946, 0.000138, 
    -0.020656, -0.004230, -0.007540, 0.004646, -0.000801, -0.011937, -0.005386, 0.024030, 
    -0.017043, -0.011730, 0.010941, 0.007759, -0.000593, -0.010175, -0.004988, -0.008494, 
    0.011976, 0.003350, -0.008219, -0.015576, 0.014735, 0.007388, -0.004021, -0.009647, 
    0.013501, 0.003579, -0.014342, 0.007199, -0.013544, 0.001824, 0.000443, 0.005888, 
    -0.007599, -0.007132, 0.006414, -0.007267, 0.006500, -0.014461, 0.007822, -0.007654, 
    -0.004952, -0.005255, 0.009694, 0.016642, -0.002955, -0.014377, -0.013397, 0.009499, 
    -0.003113, 0.016332, 0.005818, -0.004128, 0.003974, -0.010042, 0.032800, 0.007073, 
    -0.007309, 0.029381, -0.017539, -0.028479, 0.008331, -0.000633, 0.004690, 0.011237, 
    0.013446, 0.006506, 0.017380, -0.032539, -0.024094, -0.028624, 0.002181, -0.014650, 
    -0.000323, 0.002579, 0.000398, -0.006923, -0.041391, 0.030491, 0.050176, 0.076477, 
    -0.076804, 0.011013, 0.010622, 0.017374, -0.001116, 0.003750, 0.011799, 0.017162, 
    0.002813, 0.051960, 0.023945, -0.490706, -0.059417, 0.035991, 0.007159, -0.006496, 
    -0.008157, -0.006453, 0.001036, 0.002712, -0.007184, 0.013754, -0.025277, 0.063265, 
    0.075371, 0.005536, -0.035630, -0.007443, 0.015835, -0.013081, -0.001611, -0.005512, 
    -0.005088, -0.014401, -0.006383, -0.035546, 0.031397, 0.011296, -0.014619, 0.032273, 
    0.016739, 0.010840, -0.006046, 0.008504, 0.015393, -0.009557, -0.019552, 0.033717, 
    0.015784, -0.005367, 0.001682, -0.011458, 0.016660, 0.008602, 0.001785, 0.003932, 
    -0.019637, 0.011505, -0.003891, 0.008659, -0.002378, -0.002591, -0.013639, 0.017086, 
    -0.013343, -0.005729, 0.003304, 0.009625, -0.003257, 0.003706, -0.009812, 0.008666, 
    0.000068, 0.002535, -0.001127, 0.001340, -0.006424, -0.012454, -0.002509, -0.005481, 
    0.013500, 0.004553, 0.014697, -0.012580, 0.003569, -0.010980, 0.006522, -0.007351, 
    -0.000304, -0.007113, -0.009455, 0.001134, 0.001576, -0.003686, -0.003622, 0.005098, 
    0.007163, 0.006203, -0.000247, -0.000842, 0.005816, -0.001043, -0.003751, -0.015154, 
    0.008833, 0.002720, 0.036771, -0.009643, -0.041075, -0.012191, 0.004947, -0.009887, 
    -0.001174, -0.000974, -0.011244, 0.014503, -0.000629, 0.018517, -0.040815, -0.071197, 
    -0.049922, 0.032018, 0.016181, -0.010628, 0.003313, -0.001526, 0.019012, -0.000083, 
    -0.016884, 0.016412, 0.019779, 0.140029, -0.041847, -0.053714, 0.029248, -0.001632, 
    -0.022069, 0.004546, -0.002762, 0.001234, 0.016462, 0.014957, 0.030672, 0.027807, 
    -0.721684, -0.005338, 0.099802, -0.016025, 0.018767, -0.005224, 0.011967, 0.010929, 
    -0.004183, 0.006357, 0.006874, -0.023209, 0.049378, 0.155779, 0.074727, 0.001337, 
    -0.002161, -0.004532, 0.010760, -0.004676, -0.004306, -0.004451, 0.005784, -0.013389, 
    -0.029919, -0.049497, 0.069448, -0.040435, 0.036758, 0.011891, 0.001460, -0.001886, 
    0.009891, 0.000906, -0.008472, 0.005983, 0.000921, -0.003322, -0.001543, -0.000412, 
    0.052932, -0.007658, -0.027979, -0.002481, 0.003852, 0.001739, 0.003341, -0.002574, 
    -0.012004, 0.027828, -0.037732, 0.010412, -0.017281, 0.012121, 0.008826, -0.009612, 
    0.007457, -0.001435, -0.012664, 0.007047, 0.000007, -0.017022, 0.010392, 0.012792, 
    0.003092, 0.007617, -0.003118, -0.001942, 0.001653, -0.003465, 0.005340, 0.004902, 
    -0.002424, 0.004468, 0.005383, -0.011314, -0.007876, 0.001704, 0.007095, -0.004340, 
    -0.000597, 0.016247, -0.013631, -0.013013, -0.007235, -0.003933, 0.002243, 0.002462, 
    -0.004519, 0.000406, 0.006786, 0.012477, -0.011834, -0.010316, 0.003696, -0.000679, 
    0.001055, -0.008032, 0.000941, 0.001366, -0.003223, 0.007545, -0.003607, 0.000511, 
    -0.024929, -0.020322, 0.008629, -0.020227, -0.001345, 0.011091, -0.001686, 0.000895, 
    0.001087, 0.026418, -0.006121, -0.005324, 0.062654, -0.015245, -0.002653, -0.016943, 
    -0.024229, 0.018651, -0.006081, 0.004057, 0.006126, -0.004851, 0.002368, -0.012656, 
    0.020921, -0.014927, 0.016717, 0.027532, -0.156857, 0.008935, 0.036275, 0.015640, 
    0.021961, -0.018339, 0.015669, -0.004327, 0.006904, 0.007569, 0.008922, 0.004179, 
    -0.003572, 0.032729, 0.165420, 0.196658, -0.062027, 0.032497, -0.041231, 0.008782, 
    -0.022320, 0.000489, 0.008933, 0.012338, -0.013556, 0.019463, 0.010738, 0.065163, 
    -0.080513, -0.851814, 0.168240, 0.174216, -0.113920, 0.036610, 0.019376, 0.004176, 
    0.006407, 0.000431, 0.005332, -0.009303, -0.002732, -0.025309, -0.011937, 0.073646, 
    0.210437, -0.053725, -0.104708, 0.035535, -0.033564, 0.000244, 0.012667, -0.006196, 
    0.001402, -0.010678, -0.018913, 0.016577, 0.029280, -0.063728, -0.055736, 0.005846, 
    0.078861, -0.045450, 0.032870, -0.012284, -0.000520, 0.005109, -0.001909, 0.009064, 
    0.001247, -0.018698, -0.000604, 0.027235, -0.076998, 0.071317, 0.000105, 0.014654, 
    0.005896, 0.014272, -0.017604, -0.001259, -0.015821, 0.001471, 0.014913, -0.020109, 
    0.016123, -0.010096, -0.013488, 0.005302, 0.017176, 0.005161, -0.001084, -0.008506, 
    0.005268, 0.003042, -0.007190, -0.007021, 0.004451, 0.003497, -0.015716, 0.019784, 
    -0.008806, 0.012474, 0.002006, 0.001592, 0.002905, -0.000014, -0.006427, -0.010310, 
    0.001610, 0.010484, -0.007991, 0.001686, -0.004199, -0.004142, -0.001921, -0.004509, 
    0.003128, 0.001698, 0.000415, -0.001285, 0.009423, -0.027270, 0.014009, -0.004721, 
    0.001024, 0.003941, 0.003525, -0.003196, 0.009500, -0.029832, 0.018925, -0.008233, 
    -0.000539, -0.003873, 0.001989, -0.002645, -0.008724, 0.007834, -0.000358, -0.038484, 
    0.014180, 0.003635, -0.001890, 0.002944, 0.006006, -0.001842, 0.000984, 0.007662, 
    -0.001502, -0.004713, 0.017048, -0.041433, 0.030536, -0.006017, 0.008649, -0.009747, 
    0.005838, -0.005454, -0.002405, 0.004639, -0.000957, 0.002594, -0.031105, -0.020546, 
    0.059724, -0.041762, 0.038920, 0.010386, -0.007658, 0.017632, -0.013565, 0.003718, 
    -0.003436, 0.008514, 0.009417, 0.003026, 0.017575, 0.025815, 0.013080, -0.004152, 
    -0.159322, 0.060063, 0.006957, -0.074145, -0.013982, -0.003618, -0.019173, -0.006208, 
    -0.006401, -0.007224, -0.006749, -0.013360, 0.037320, -0.003379, 0.089353, 0.139459, 
    0.219977, -0.172250, 0.051915, -0.014653, 0.023551, -0.009222, -0.000707, 0.021456, 
    0.028203, -0.002863, 0.056865, 0.029882, 0.185071, -0.266421, -0.676891, -0.550514, 
    -0.043554, 0.081200, -0.006453, -0.005573, 0.001735, 0.011219, -0.004150, -0.010716, 
    0.020257, 0.019280, 0.000773, -0.221702, 0.149122, 0.160614, 0.151457, -0.004386, 
    -0.056352, -0.009221, 0.003470, -0.006215, 0.000170, 0.007426, 0.002984, -0.010663, 
    -0.059057, 0.034090, -0.032591, -0.099084, 0.147374, -0.023783, 0.126578, -0.006407, 
    -0.014066, 0.009990, 0.003305, 0.005454, -0.011341, -0.005257, 0.017686, -0.001027, 
    -0.034738, 0.056115, -0.034007, 0.045876, 0.030710, -0.040390, 0.017981, -0.008189, 
    0.019181, -0.010376, -0.001236, -0.000515, -0.021176, 0.020631, -0.022538, 0.018448, 
    0.015548, -0.048050, -0.021563, 0.026950, -0.004119, 0.008866, 0.006105, 0.004142, 
    0.008257, -0.011806, 0.002385, -0.010917, -0.010565, 0.015771, 0.001722, 0.005453, 
    0.002640, 0.005871, -0.004728, 0.001965, 0.000225, -0.002648, -0.005182, -0.000536, 
    0.000160, 0.003985, 0.001429, -0.003644, -0.000830, -0.000580, -0.000135, -0.001667, 
    -0.005032, 0.005601, -0.000431, 0.002538, -0.015017, 0.033739, 0.075466, -0.032248, 
    0.008401, -0.012023, -0.002341, 0.002707, 0.006104, 0.009400, 0.032812, 0.096301, 
    -0.033256, 0.012211, -0.017367, 0.006955, -0.002389, 0.005929, 0.002100, 0.007423, 
    -0.008665, -0.011016, 0.052430, 0.114798, -0.057260, 0.031963, -0.019904, -0.004071, 
    0.003538, -0.002632, 0.002557, -0.001287, 0.011312, 0.017116, -0.010025, 0.029580, 
    0.166942, -0.042802, 0.016791, -0.034497, 0.024371, -0.030389, 0.001418, 0.004018, 
    -0.008585, 0.013241, 0.010064, 0.022508, -0.035589, 0.109210, 0.243362, -0.180242, 
    0.060436, -0.082123, 0.046101, -0.014044, -0.007820, -0.000831, 0.010847, 0.011537, 
    0.002158, 0.051506, -0.025519, 0.049326, 0.308597, 0.361557, -0.135274, 0.069079, 
    -0.010564, -0.047110, -0.014148, -0.013981, -0.002620, -0.018596, -0.006129, -0.042335, 
    -0.053356, -0.019187, -0.191421, -0.444684, 2.530146, -0.359184, -0.101668, 0.046840, 
    0.011397, -0.001536, 0.027972, 0.012331, 0.020938, 0.029363, 0.021827, 0.027147, 
    -0.023919, 0.019428, 0.608315, -3.541306, 1.173074, -0.431140, 0.173039, 0.012747, 
    0.033995, 0.044079, 0.030664, 0.027669, 0.006716, -0.003067, 0.023460, 0.134531, 
    0.050608, 0.006328, -0.307512, 0.340465, -0.190554, 0.007354, -0.045173, -0.010768, 
    -0.014485, -0.024806, -0.019124, -0.007551, 0.016462, -0.036218, -0.002224, -0.002077, 
    -0.274020, -0.122504, 0.084978, 0.034508, 0.039533, 0.050510, -0.013021, 0.009113, 
    0.009710, -0.004540, -0.008388, 0.001294, 0.050077, -0.092399, 0.096335, -0.038030, 
    -0.287341, 0.096401, -0.007530, 0.015388, 0.002229, 0.019940, -0.001715, 0.002490, 
    0.009327, -0.021352, -0.003997, 0.007057, 0.001074, -0.025402, -0.204206, 0.059199, 
    0.007258, 0.009496, -0.003435, 0.006306, 0.011302, -0.003462, 0.024231, -0.009412, 
    -0.004827, 0.003392, -0.029015, -0.149278, 0.067645, -0.015871, 0.008341, -0.010245, 
    -0.002784, 0.006686, -0.009531, -0.002806, -0.001645, 0.004070, -0.018069, -0.140303, 
    0.045814, -0.006149, 0.008867, 0.006396, 0.006059, -0.002165, 0.004256, -0.017405, 
    -0.125992, 0.049727, -0.009848, 0.009700, -0.202257, 0.004277, -0.005274, -0.040731, 
    -0.227285, -0.066586, -0.000384, 0.000246, -0.001259, -0.003398, 0.006983, 0.002372, 
    -0.057600, -0.266884, -0.084540, -0.002876, -0.005439, 0.001825, -0.001449, 0.001139, 
    -0.001411, 0.011741, -0.013164, -0.012309, -0.069199, -0.337390, -0.100399, 0.008734, 
    0.006893, -0.001306, -0.006054, 0.015750, 0.005456, 0.009139, -0.006761, 0.016737, 
    0.005063, -0.091530, -0.383773, -0.101407, -0.005765, -0.016491, 0.039729, -0.023456, 
    -0.009334, 0.003575, -0.004498, 0.003676, -0.013498, 0.028941, -0.005973, -0.054972, 
    -0.528054, -0.242654, -0.011942, 0.037951, -0.052976, 0.020034, 0.002486, 0.002197, 
    -0.013665, -0.008293, -0.017866, -0.007207, -0.032210, -0.036203, -0.313099, -0.654335, 
    -0.003073, -0.203467, 0.162096, -0.054919, 0.015620, 0.017190, 0.001117, -0.007403, 
    0.008344, -0.026973, 0.019380, -0.026085, 0.115995, -0.621722, -2.860951, -0.713213, 
    0.103314, 0.017381, 0.058781, -0.011451, 0.000633, 0.004297, -0.181586, -0.207845, 
    -0.264194, -0.297158, -0.359696, -0.361693, -1.260672, -1.841539, 0.000000, 1.841539, 
    1.260672, 0.361693, 0.359696, 0.297158, 0.264194, 0.207845, -0.004297, -0.000633, 
    0.011451, -0.058781, -0.017381, -0.103314, 0.713213, 2.860952, 0.621722, -0.115995, 
    0.026085, -0.019380, 0.026973, -0.008344, 0.007403, -0.001117, -0.017190, -0.015620, 
    0.054919, -0.162096, 0.203467, 0.003073, 0.654335, 0.313099, 0.036203, 0.032210, 
    0.007207, 0.017866, 0.008293, 0.013665, -0.002197, -0.002486, -0.020034, 0.052976, 
    -0.037951, 0.011942, 0.242654, 0.528054, 0.054972, 0.005973, -0.028941, 0.013498, 
    -0.003676, 0.004498, -0.003575, 0.009334, 0.023456, -0.039729, 0.016491, 0.005765, 
    0.101407, 0.383773, 0.091530, -0.005063, -0.016737, 0.006761, -0.009139, -0.005456, 
    -0.015750, 0.006054, 0.001306, -0.006893, -0.008734, 0.100399, 0.337390, 0.069199, 
    0.012309, 0.013164, -0.011741, 0.001411, -0.001139, 0.001449, -0.001825, 0.005439, 
    0.002876, 0.084540, 0.266884, 0.057600, -0.002372, -0.006983, 0.003398, 0.001259, 
    -0.000246, 0.000384, 0.066586, 0.227285, 0.040731, 0.005274, -0.004277, -0.009700, 
    0.009848, -0.049727, 0.125992, 0.017405, -0.004256, 0.002165, -0.006059, -0.006396, 
    -0.008867, 0.006149, -0.045814, 0.140303, 0.018069, -0.004070, 0.001645, 0.002806, 
    0.009531, -0.006686, 0.002784, 0.010245, -0.008341, 0.015871, -0.067645, 0.149278, 
    0.029015, -0.003392, 0.004827, 0.009412, -0.024231, 0.003462, -0.011302, -0.006306, 
    0.003435, -0.009496, -0.007258, -0.059199, 0.204206, 0.025402, -0.001074, -0.007057, 
    0.003997, 0.021352, -0.009327, -0.002490, 0.001715, -0.019940, -0.002229, -0.015388, 
    0.007530, -0.096401, 0.287341, 0.038030, -0.096335, 0.092399, -0.050077, -0.001294, 
    0.008388, 0.004540, -0.009710, -0.009113, 0.013021, -0.050510, -0.039533, -0.034508, 
    -0.084978, 0.122504, 0.274020, 0.002077, 0.002224, 0.036218, -0.016462, 0.007551, 
    0.019124, 0.024806, 0.014485, 0.010768, 0.045173, -0.007354, 0.190554, -0.340465, 
    0.307512, -0.006328, -0.050608, -0.134531, -0.023460, 0.003067, -0.006716, -0.027669, 
    -0.030664, -0.044079, -0.033995, -0.012747, -0.173039, 0.431140, -1.173074, 3.541306, 
    -0.608315, -0.019428, 0.023919, -0.027147, -0.021827, -0.029363, -0.020938, -0.012331, 
    -0.027972, 0.001536, -0.011397, -0.046840, 0.101668, 0.359184, -2.530146, 0.444684, 
    0.191421, 0.019187, 0.053356, 0.042335, 0.006129, 0.018596, 0.002620, 0.013981, 
    0.014148, 0.047110, 0.010564, -0.069079, 0.135274, -0.361557, -0.308597, -0.049326, 
    0.025519, -0.051506, -0.002158, -0.011537, -0.010847, 0.000831, 0.007820, 0.014044, 
    -0.046101, 0.082123, -0.060436, 0.180242, -0.243362, -0.109210, 0.035589, -0.022508, 
    -0.010064, -0.013241, 0.008585, -0.004018, -0.001418, 0.030389, -0.024371, 0.034497, 
    -0.016791, 0.042802, -0.166942, -0.029580, 0.010025, -0.017116, -0.011312, 0.001287, 
    -0.002557, 0.002632, -0.003538, 0.004071, 0.019904, -0.031963, 0.057260, -0.114798, 
    -0.052430, 0.011016, 0.008665, -0.007423, -0.002100, -0.005929, 0.002389, -0.006955, 
    0.017367, -0.012211, 0.033256, -0.096301, -0.032812, -0.009400, -0.006104, -0.002707, 
    0.002341, 0.012023, -0.008401, 0.032248, -0.075466, -0.033739, 0.015017, -0.002538, 
    0.000431, -0.005601, 0.005032, 0.001667, 0.000135, 0.000580, 0.000830, 0.003644, 
    -0.001429, -0.003985, -0.000160, 0.000536, 0.005182, 0.002648, -0.000225, -0.001965, 
    0.004728, -0.005871, -0.002640, -0.005453, -0.001722, -0.015771, 0.010565, 0.010917, 
    -0.002385, 0.011806, -0.008257, -0.004142, -0.006105, -0.008866, 0.004119, -0.026950, 
    0.021563, 0.048050, -0.015548, -0.018448, 0.022538, -0.020631, 0.021176, 0.000515, 
    0.001236, 0.010376, -0.019181, 0.008189, -0.017981, 0.040390, -0.030710, -0.045876, 
    0.034007, -0.056115, 0.034738, 0.001027, -0.017686, 0.005257, 0.011341, -0.005454, 
    -0.003305, -0.009990, 0.014066, 0.006407, -0.126578, 0.023783, -0.147374, 0.099084, 
    0.032591, -0.034090, 0.059057, 0.010663, -0.002984, -0.007426, -0.000170, 0.006215, 
    -0.003470, 0.009221, 0.056352, 0.004386, -0.151457, -0.160614, -0.149122, 0.221702, 
    -0.000773, -0.019280, -0.020257, 0.010716, 0.004150, -0.011219, -0.001735, 0.005573, 
    0.006453, -0.081200, 0.043554, 0.550514, 0.676891, 0.266421, -0.185071, -0.029882, 
    -0.056865, 0.002863, -0.028203, -0.021456, 0.000707, 0.009222, -0.023551, 0.014653, 
    -0.051915, 0.172250, -0.219977, -0.139459, -0.089353, 0.003379, -0.037320, 0.013360, 
    0.006749, 0.007224, 0.006401, 0.006208, 0.019173, 0.003618, 0.013982, 0.074145, 
    -0.006957, -0.060063, 0.159322, 0.004152, -0.013080, -0.025815, -0.017575, -0.003026, 
    -0.009417, -0.008514, 0.003436, -0.003718, 0.013565, -0.017632, 0.007658, -0.010386, 
    -0.038920, 0.041762, -0.059724, 0.020546, 0.031105, -0.002594, 0.000957, -0.004639, 
    0.002405, 0.005454, -0.005838, 0.009747, -0.008649, 0.006017, -0.030536, 0.041433, 
    -0.017048, 0.004713, 0.001502, -0.007662, -0.000984, 0.001842, -0.006006, -0.002944, 
    0.001890, -0.003635, -0.014180, 0.038484, 0.000358, -0.007834, 0.008724, 0.002645, 
    -0.001989, 0.003873, 0.000539, 0.008233, -0.018925, 0.029832, -0.009500, 0.003196, 
    -0.003525, -0.003941, -0.001024, 0.004721, -0.014009, 0.027270, -0.009423, 0.001285, 
    -0.000415, -0.001698, -0.003128, 0.004509, 0.001921, 0.004142, 0.004199, -0.001686, 
    0.007991, -0.010484, -0.001610, 0.010310, 0.006427, 0.000014, -0.002905, -0.001592, 
    -0.002006, -0.012474, 0.008806, -0.019784, 0.015716, -0.003497, -0.004451, 0.007021, 
    0.007190, -0.003042, -0.005268, 0.008506, 0.001084, -0.005161, -0.017176, -0.005302, 
    0.013488, 0.010096, -0.016123, 0.020109, -0.014913, -0.001471, 0.015821, 0.001259, 
    0.017604, -0.014272, -0.005896, -0.014654, -0.000105, -0.071317, 0.076998, -0.027235, 
    0.000604, 0.018698, -0.001247, -0.009064, 0.001909, -0.005109, 0.000520, 0.012284, 
    -0.032870, 0.045450, -0.078861, -0.005846, 0.055736, 0.063728, -0.029280, -0.016577, 
    0.018913, 0.010678, -0.001402, 0.006196, -0.012667, -0.000244, 0.033564, -0.035535, 
    0.104708, 0.053725, -0.210437, -0.073646, 0.011937, 0.025309, 0.002732, 0.009303, 
    -0.005332, -0.000431, -0.006407, -0.004176, -0.019376, -0.036610, 0.113920, -0.174216, 
    -0.168240, 0.851814, 0.080513, -0.065163, -0.010738, -0.019463, 0.013556, -0.012338, 
    -0.008933, -0.000489, 0.022320, -0.008782, 0.041231, -0.032497, 0.062027, -0.196658, 
    -0.165420, -0.032729, 0.003572, -0.004179, -0.008922, -0.007569, -0.006904, 0.004327, 
    -0.015669, 0.018339, -0.021961, -0.015640, -0.036275, -0.008935, 0.156857, -0.027532, 
    -0.016717, 0.014927, -0.020921, 0.012656, -0.002368, 0.004851, -0.006126, -0.004057, 
    0.006081, -0.018651, 0.024229, 0.016943, 0.002653, 0.015245, -0.062654, 0.005324, 
    0.006121, -0.026418, -0.001087, -0.000895, 0.001686, -0.011091, 0.001345, 0.020227, 
    -0.008629, 0.020322, 0.024929, -0.000511, 0.003607, -0.007545, 0.003223, -0.001366, 
    -0.000941, 0.008032, -0.001055, 0.000679, -0.003696, 0.010316, 0.011834, -0.012477, 
    -0.006786, -0.000406, 0.004519, -0.002462, -0.002243, 0.003933, 0.007235, 0.013013, 
    0.013631, -0.016247, 0.000597, 0.004340, -0.007095, -0.001704, 0.007876, 0.011314, 
    -0.005383, -0.004468, 0.002424, -0.004902, -0.005340, 0.003465, -0.001653, 0.001942, 
    0.003118, -0.007617, -0.003092, -0.012792, -0.010392, 0.017022, -0.000007, -0.007047, 
    0.012664, 0.001435, -0.007457, 0.009612, -0.008826, -0.012121, 0.017281, -0.010412, 
    0.037732, -0.027828, 0.012004, 0.002574, -0.003341, -0.001739, -0.003852, 0.002481, 
    0.027979, 0.007658, -0.052932, 0.000412, 0.001543, 0.003322, -0.000921, -0.005983, 
    0.008472, -0.000906, -0.009891, 0.001886, -0.001460, -0.011891, -0.036758, 0.040435, 
    -0.069447, 0.049497, 0.029919, 0.013389, -0.005784, 0.004451, 0.004306, 0.004676, 
    -0.010760, 0.004532, 0.002161, -0.001337, -0.074727, -0.155779, -0.049378, 0.023209, 
    -0.006874, -0.006357, 0.004183, -0.010929, -0.011967, 0.005224, -0.018767, 0.016025, 
    -0.099802, 0.005338, 0.721684, -0.027807, -0.030672, -0.014957, -0.016462, -0.001234, 
    0.002762, -0.004546, 0.022069, 0.001632, -0.029248, 0.053714, 0.041847, -0.140029, 
    -0.019779, -0.016412, 0.016884, 0.000083, -0.019012, 0.001526, -0.003313, 0.010628, 
    -0.016181, -0.032018, 0.049922, 0.071197, 0.040815, -0.018517, 0.000629, -0.014503, 
    0.011244, 0.000974, 0.001174, 0.009887, -0.004947, 0.012191, 0.041075, 0.009643, 
    -0.036771, -0.002720, -0.008833, 0.015154, 0.003751, 0.001043, -0.005816, 0.000842, 
    0.000247, -0.006203, -0.007163, -0.005098, 0.003622, 0.003686, -0.001576, -0.001134, 
    0.009455, 0.007113, 0.000304, 0.007351, -0.006522, 0.010980, -0.003569, 0.012580, 
    -0.014697, -0.004553, -0.013500, 0.005481, 0.002509, 0.012454, 0.006424, -0.001340, 
    0.001127, -0.002535, -0.000068, -0.008666, 0.009812, -0.003706, 0.003257, -0.009625, 
    -0.003304, 0.005729, 0.013343, -0.017086, 0.013639, 0.002591, 0.002378, -0.008659, 
    0.003891, -0.011505, 0.019637, -0.003932, -0.001785, -0.008602, -0.016660, 0.011458, 
    -0.001682, 0.005367, -0.015784, -0.033717, 0.019552, 0.009557, -0.015393, -0.008504, 
    0.006046, -0.010840, -0.016739, -0.032273, 0.014619, -0.011296, -0.031397, 0.035546, 
    0.006383, 0.014401, 0.005088, 0.005512, 0.001611, 0.013081, -0.015835, 0.007443, 
    0.035630, -0.005536, -0.075371, -0.063265, 0.025277, -0.013754, 0.007184, -0.002712, 
    -0.001036, 0.006453, 0.008157, 0.006496, -0.007159, -0.035991, 0.059417, 0.490706, 
    -0.023945, -0.051960, -0.002813, -0.017162, -0.011799, -0.003750, 0.001116, -0.017374, 
    -0.010622, -0.011013, 0.076804, -0.076477, -0.050176, -0.030491, 0.041391, 0.006923, 
    -0.000398, -0.002579, 0.000323, 0.014650, -0.002181, 0.028624, 0.024094, 0.032539, 
    -0.017380, -0.006506, -0.013446, -0.011237, -0.004690, 0.000633, -0.008331, 0.028479, 
    0.017539, -0.029381, 0.007309, -0.007073, -0.032800, 0.010042, -0.003974, 0.004128, 
    -0.005818, -0.016332, 0.003113, -0.009499, 0.013397, 0.014377, 0.002955, -0.016642, 
    -0.009694, 0.005255, 0.004952, 0.007654, -0.007822, 0.014461, -0.006500, 0.007267, 
    -0.006414, 0.007132, 0.007599, -0.005888, -0.000443, -0.001824, 0.013544, -0.007199, 
    0.014342, -0.003579, -0.013501, 0.009647, 0.004021, -0.007388, -0.014735, 0.015576, 
    0.008219, -0.003350, -0.011976, 0.008494, 0.004988, 0.010175, 0.000593, -0.007759, 
    -0.010941, 0.011730, 0.017043, -0.024030, 0.005386, 0.011937, 0.000801, -0.004646, 
    0.007540, 0.004230, 0.020656, -0.000138, -0.042946, -0.114359, -0.042547, 0.024635, 
    -0.009523, 0.002958, 0.006546, 0.002884, 0.009395, -0.021599, -0.045097, 0.091509, 
    0.465769, -0.024747, -0.038679, -0.009434, -0.007556, -0.014185, 0.010636, -0.001257, 
    -0.010609, 0.033278, -0.071264, -0.065626, -0.038571, 0.025808, 0.008424, -0.007130, 
    0.004406, 0.005020, 0.028494, -0.011440, 0.026651, -0.004472, 0.013480, -0.019759, 
    -0.003861, -0.000431, 0.001907, -0.011845, -0.017781, -0.020559, 0.020155, -0.013546, 
    0.011196, 0.001694, -0.000013, -0.007094, 0.001378, -0.000295, 0.005648, 0.004491, 
    -0.001324, 0.003670, 0.000421, -0.003055, -0.004356, -0.005506, -0.007456, -0.015100, 
    -0.002055, -0.004552, -0.018567, -0.003262, 0.006057, -0.020490, 0.006272, 0.027277, 
    0.004406, 0.008845, 0.009877, -0.011598, -0.075341, -0.037703, 0.005805, -0.010359, 
    -0.005930, -0.011763, 0.047676, 0.338155, -0.017831, -0.017885, -0.008504, -0.002076, 
    0.015837, -0.052972, -0.051486, -0.018323, 0.017460, 0.003774, -0.006601, 0.022387, 
    0.009927, 0.006476, 0.004715, -0.020171, -0.005186, -0.009136, -0.004786, 0.015943, 
    -0.011190, 0.001000
);

fn mainModel4(xyz: vec3f) -> vec4f {
    let v = (xyz - MIN_BOUND) / VOXEL_SIZE;
    let vi = vec3i(floor(v + vec3f(0.5)));
    let iy = i32(floor(v.y));
    let iz = i32(floor(v.z));

    var d: f32 = 0.0;
    const TWO_PI: f32 = 6.28318530718;
    const half_k: i32 = 8;
    const r2: f32 = 64.0;

    var cos_x: array<f32, 16>; var sin_x: array<f32, 16>;
    var cos_y: array<f32, 16>; var sin_y: array<f32, 16>;
    var cos_z: array<f32, 16>; var sin_z: array<f32, 16>;

    for (var i: i32 = 0; i < 16; i++) {
        let f = f32(i - half_k);
        let ax = TWO_PI * f * v.x / DIMS.x;
        let ay = TWO_PI * f * v.y / DIMS.y;
        let az = TWO_PI * f * v.z / DIMS.z;
        cos_x[i] = cos(ax); sin_x[i] = sin(ax);
        cos_y[i] = cos(ay); sin_y[i] = sin(ay);
        cos_z[i] = cos(az); sin_z[i] = sin(az);
    }

    var idx: i32 = 0;
    for (var dz: i32 = 0; dz < 16; dz++) {
        let fz = f32(dz - half_k);
        let fz2 = fz * fz;
        for (var dy: i32 = 0; dy < 16; dy++) {
            let fy = f32(dy - half_k);
            let fy2 = fy * fy;
            let cycz = cos_y[dy] * cos_z[dz];
            let cysz = cos_y[dy] * sin_z[dz];
            let sycz = sin_y[dy] * cos_z[dz];
            let sysz = sin_y[dy] * sin_z[dz];

            for (var dx: i32 = 0; dx < 16; dx++) {
                let fx = f32(dx - half_k);
                if (fx*fx + fy2 + fz2 <= r2) {
                    // Use trigonometric identities to avoid cos/sin inside the inner loop
                    // cos(a+b+c) = cos(a)cos(b+c) - sin(a)sin(b+c)
                    // sin(a+b+c) = sin(a)cos(b+c) + cos(a)sin(b+c)
                    // where:
                    // cos(b+c) = cos(b)cos(c) - sin(b)sin(c)
                    // sin(b+c) = sin(b)cos(c) + cos(b)sin(c)

                    let cos_bc = cycz - sysz;
                    let sin_bc = sycz + cysz;

                    let cos_abc = cos_x[dx] * cos_bc - sin_x[dx] * sin_bc;
                    let sin_abc = sin_x[dx] * cos_bc + cos_x[dx] * sin_bc;

                    d += coeffs_re[idx] * cos_abc - coeffs_im[idx] * sin_abc;
                    idx++;
                }
            }
        }
    }
    if (d < 0.0) { return solidMaterial; }

    return vec4f(0.0, 0.0, 0.0, 0.0);
}
